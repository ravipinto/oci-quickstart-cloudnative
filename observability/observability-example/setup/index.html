<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <title>Setup :: MuShop</title>
  
  <meta name="application-name" content="MuShop"/>
<meta name="description" content="Oracle Cloud Native Workshop">
<meta name="keywords" content="Kubernetes,OCI,OKE,Microservices">

<meta property="og:title" content="MuShop - Setup" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/observability/observability-example/setup/" />
    <link rel="apple-touch-icon" sizes="180x180" href="../../../icons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../../../icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../../icons/favicon-16x16.png">
  <link rel="manifest" href="../../../icons/site.webmanifest">
  <link rel="mask-icon" href="../../../icons/safari-pinned-tab.svg" color="#41727e">
  <meta name="msapplication-TileColor" content="#c74634">
  <meta name="theme-color" content="#fcfbfa">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <link rel="stylesheet" type="text/css" href="../../../sass/main.min.579b1ef900caab9f4034f2fab782c459ab9ddb6c2dd914fed6155812ffd82484.css" integrity="sha256-V5se&#43;QDKq59ANPL6t4LEWaud22wt2RT&#43;1hVYEv/YJIQ=">
  <link rel="stylesheet" type="text/css" href="../../../fonts/fonts.min.58744946497c59fa8a6ac77636ea480457079e54512cf3dcb552592b56503cc1.css" integrity="sha256-WHRJRkl8WfqKasd2NupIBFcHnlRRLPPctVJZK1ZQPME=">
  <link rel="stylesheet" type="text/css" href="../../../sass/mushop.min.c31ca585e7b3a90dfeb2fd0ac2d7d93ff0af82ea19b0cab20c8539d987761606.css" integrity="sha256-wxylheezqQ3&#43;sv0KwtfZP/CvguoZsMqyDIU52Yd2FgY=">
</head>

  <body class="" data-url="../../../observability/observability-example/setup/">
    
<div class="uk-navbar-container uk-hidden@s">
  <div class="">
    <nav role="navigation" class="uk-light uk-navbar" uk-navbar>
      <div class="uk-navbar-left">
        <a href="../../../index.html" class="uk-navbar-item uk-logo">
          <img
            alt="MuShop"
            class="uk-width-small"
            src="../../../images/logo.dark.png">
        </a>
      </div>
      <div class="uk-navbar-right">
        <a class="uk-navbar-toggle" uk-navbar-toggle-icon uk-toggle="target: #navigation"></a>
      </div>
    </nav>
  </div>
</div>


<div class="uk-grid">
  
  
  <aside
    id="navigation"
    class="rw-sidebar uk-offcanvas uk-width-1-1 uk-width-1-3@s uk-width-1-4@m uk-width-1-5@l uk-width-1-6@xl uk-light uk-padding-remove"
    uk-offcanvas="overlay: true;">
    <div class="uk-offcanvas-bar uk-padding-small">
      
      
      <section>
        <div class="uk-margin-bottom uk-visible@s">
          <a href="../../../index.html" class="uk-logo">
            <img src="../../../images/logo.dark.png" alt="MuShop">
          </a>
        </div>
        <div class="uk-margin-bottom">
          <form class="uk-search uk-search-default uk-width-expand">
  <span class="uk-search-icon-flip" uk-search-icon></span>
  <input id="search" class="uk-search-input uk-width-expand" type="search" placeholder="Search...">
</form>
<div id="search-results" class="uk-background-primary uk-text-small"></div>
        </div>
        <ul class="uk-nav uk-nav-primary" uk-nav="multiple: true; toggle: > a .uk-icon">
          <li class="uk-nav-divider"></li>
          
            


  
  
  
  <li data-nav-id="/introduction/" title="Introduction" class="">
    <a href="../../../introduction/">
      <div class="uk-flex uk-flex-between uk-flex-middle">
        <div class="uk-text-truncate">Introduction</div>
      </div>
    </a>
    
    
  </li>
  

 

          
            


  
  
  
  <li data-nav-id="/quickstart/" title="Getting Started" class=" uk-parent">
    <a href="../../../quickstart/">
      <div class="uk-flex uk-flex-between uk-flex-middle">
        <div class="uk-text-truncate">Getting Started</div><span class="uk-flex-none" uk-icon="icon: triangle-right; ratio: 1.5"></span>
      </div>
    </a>
    
    
    <ul class="uk-nav-sub">
      
      
      
      
      
        
        


  
    
    <li data-nav-id="/quickstart/basic/" title="Always Free" class="">
      <a href="../../../quickstart/basic/" class="uk-text-truncate">
        Always Free
      </a>
    </li>
    
  

 

        
      
        
        


  
    
    <li data-nav-id="/quickstart/kubernetes/" title="Kubernetes Deployment" class="">
      <a href="../../../quickstart/kubernetes/" class="uk-text-truncate">
        Kubernetes Deployment
      </a>
    </li>
    
  

 

        
      
    </ul>
  
  </li>
  

 

          
            


  
  
  
  <li data-nav-id="/cloud/" title="Cloud Infrastructure" class=" uk-parent">
    <a href="../../../cloud/">
      <div class="uk-flex uk-flex-between uk-flex-middle">
        <div class="uk-text-truncate">Cloud Infrastructure</div><span class="uk-flex-none" uk-icon="icon: triangle-right; ratio: 1.5"></span>
      </div>
    </a>
    
    
    <ul class="uk-nav-sub">
      
      
      
      
      
        
        


  
    
    <li data-nav-id="/cloud/prerequisites/" title="Prerequisites" class="">
      <a href="../../../cloud/prerequisites/" class="uk-text-truncate">
        Prerequisites
      </a>
    </li>
    
  

 

        
      
        
        


  
    
    <li data-nav-id="/cloud/setup/" title="Setup" class="">
      <a href="../../../cloud/setup/" class="uk-text-truncate">
        Setup
      </a>
    </li>
    
  

 

        
      
        
        


  
    
    <li data-nav-id="/cloud/deployment/" title="Deployment" class="">
      <a href="../../../cloud/deployment/" class="uk-text-truncate">
        Deployment
      </a>
    </li>
    
  

 

        
      
    </ul>
  
  </li>
  

 

          
            


  
  
  
  <li data-nav-id="/observability/" title="Observability" class=" uk-parent uk-open">
    <a href="../../../observability/">
      <div class="uk-flex uk-flex-between uk-flex-middle">
        <div class="uk-text-truncate">Observability</div><span class="uk-flex-none" uk-icon="icon: triangle-right; ratio: 1.5"></span>
      </div>
    </a>
    
    
    <ul class="uk-nav-sub">
      
      
        
      
      
      
      
        
        


  
    
    <li data-nav-id="/observability/monitoring/" title="Grafana Monitoring" class="">
      <a href="../../../observability/monitoring/" class="uk-text-truncate">
        Grafana Monitoring
      </a>
    </li>
    
  

 

        
      
        
        


  
    
    <li data-nav-id="/observability/istio/" title="Istio Service Mesh" class="">
      <a href="../../../observability/istio/" class="uk-text-truncate">
        Istio Service Mesh
      </a>
    </li>
    
  

 

        
      
        
        


  
    
    <li data-nav-id="/observability/canary/" title="Canary Deployment" class="">
      <a href="../../../observability/canary/" class="uk-text-truncate">
        Canary Deployment
      </a>
    </li>
    
  

 

        
      
        
        


  
    
    <li data-nav-id="/observability/oci-monitoring/" title="OCI Monitoring" class="">
      <a href="../../../observability/oci-monitoring/" class="uk-text-truncate">
        OCI Monitoring
      </a>
    </li>
    
  

 

        
      
        
        


  
    
    <li data-nav-id="/observability/oci-healthcheck/" title="OCI Health Checks" class="">
      <a href="../../../observability/oci-healthcheck/" class="uk-text-truncate">
        OCI Health Checks
      </a>
    </li>
    
  

 

        
      
        
        


  
  
  
  <li data-nav-id="/observability/observability-example/" title="Observability Example" class=" uk-parent uk-open">
    <a href="../../../observability/observability-example/">
      <div class="uk-flex uk-flex-between uk-flex-middle">
        <div class="uk-text-truncate">Observability Example</div><span class="uk-flex-none" uk-icon="icon: triangle-right; ratio: 1.5"></span>
      </div>
    </a>
    
    
    <ul class="uk-nav-sub">
      
      
      
      
      
        
        


  
    
    <li data-nav-id="/observability/observability-example/setup/" title="Setup" class="uk-active">
      <a href="../../../observability/observability-example/setup/" class="uk-text-truncate">
        Setup
      </a>
    </li>
    
  

 

        
      
        
        


  
    
    <li data-nav-id="/observability/observability-example/usecase/" title="Use Case" class="">
      <a href="../../../observability/observability-example/usecase/" class="uk-text-truncate">
        Use Case
      </a>
    </li>
    
  

 

        
      
    </ul>
  
  </li>
  

 

        
      
    </ul>
  
  </li>
  

 

          
            


  
  
  
  <li data-nav-id="/extras/" title="Extras" class=" uk-parent">
    <a href="../../../extras/">
      <div class="uk-flex uk-flex-between uk-flex-middle">
        <div class="uk-text-truncate">Extras</div><span class="uk-flex-none" uk-icon="icon: triangle-right; ratio: 1.5"></span>
      </div>
    </a>
    
    
    <ul class="uk-nav-sub">
      
      
      
      
      
        
        


  
    
    <li data-nav-id="/extras/jenkins/" title="Jenkins" class="">
      <a href="../../../extras/jenkins/" class="uk-text-truncate">
        Jenkins
      </a>
    </li>
    
  

 

        
      
    </ul>
  
  </li>
  

 

          
            


  
  
  
  <li data-nav-id="/cleanup/" title="Cleanup" class="">
    <a href="../../../cleanup/">
      <div class="uk-flex uk-flex-between uk-flex-middle">
        <div class="uk-text-truncate">Cleanup</div>
      </div>
    </a>
    
    
  </li>
  

 

          
          <li class="uk-nav-divider"></li>
        </ul>
      </section>
      
      <section>
        <ul class="uk-nav uk-nav-default" uk-nav>
          
          
          <li>
            <a title="More Information" href="../../../resources" class="uk-text-truncate">
              <span uk-icon='icon: info; ratio: 1.25'></span>
              <span class="uk-text-middle">More Information</span>
              
            </a>
          </li>
          <li>
            <a title="Acknowledgements" href="../../../acknowledgements" class="uk-text-truncate">
              <span uk-icon='icon: users; ratio: 1.25'></span>
              <span class="uk-text-middle">Acknowledgements</span>
              
            </a>
          </li>
          <li>
            <a title="Tags" href="../../../tags" class="uk-text-truncate">
              <span uk-icon='icon: tag; ratio: 1.25'></span>
              <span class="uk-text-middle">Tags</span>
              
            </a>
          </li>
          <li>
            <a title="GitHub Source" href="https://github.com/oracle-quickstart/oci-cloudnative" class="uk-text-truncate">
              <span uk-icon='icon: github; ratio: 1.25'></span>
              <span class="uk-text-middle">GitHub Source</span>
              
            </a>
          </li>
          <li>
            <a title="Report Issue" href="https://github.com/oracle-quickstart/oci-cloudnative/issues" class="uk-text-truncate">
              <span uk-icon='icon: warning; ratio: 1.25'></span>
              <span class="uk-text-middle">Report Issue</span>
              
            </a>
          </li>
            <li>
              <a title='Edit this page' href="https://github.com/oracle-quickstart/oci-cloudnative/tree/master/src/docs/content/observability/observability-example/setup.md" target="blank">
                <span uk-icon="pencil"></span>
                <span class="uk-text-middle">Edit this page</span>
              </a>
            </li>
            
          
        </ul>
      </section>
      <section class="uk-margin-top">
        <hr>
        <ul id="rw-settings" class="uk-nav uk-nav-default" uk-nav>
  <li class="uk-grid uk-grid-small uk-flex-middle uk-flex-between uk-flex-nowrap uk-text-nowrap">
  <div class="uk-width-1-4">
    
    <span>Theme</span>
  </div>
  <div class="uk-button-group rw-setting"
    setting="theme"
    target="html, .content-container" ><button class="uk-button uk-button-small uk-button-secondary
    uk-active" toggle="uk-background-default" >
      Light
    </button><button class="uk-button uk-button-small uk-button-secondary
    " toggle="uk-light uk-background-secondary" >
      Dark
    </button></div>
</li>


  <li class="uk-grid uk-grid-small uk-flex-middle uk-flex-between uk-flex-nowrap uk-text-nowrap">
  <div class="uk-width-1-4">
    
    <span>OS</span>
  </div>
  <div class="uk-button-group rw-setting"
    setting="platform"
    target="html" ><button class="uk-button uk-button-small uk-button-secondary
    uk-active" toggle="stg-os-macos" >
      Mac
    </button><button class="uk-button uk-button-small uk-button-secondary
    " toggle="stg-os-linux" >
      Linux
    </button><button class="uk-button uk-button-small uk-button-secondary
    " toggle="stg-os-windows" >
      Windows
    </button></div>
</li>
<li class="uk-grid uk-grid-small uk-flex-middle uk-flex-between uk-flex-nowrap uk-text-nowrap">
  <div class="uk-width-1-4">
    
    <span>Helm</span>
  </div>
  <div class="uk-button-group rw-setting"
    setting="helm"
    target="html" ><button class="uk-button uk-button-small uk-button-secondary
    uk-active" toggle="stg-helm-3" >
      3.x
    </button><button class="uk-button uk-button-small uk-button-secondary
    " toggle="stg-helm-2" >
      2.x
    </button></div>
</li>
</ul>



      </section>
      <section class="uk-text-small uk-text-lighter uk-margin-top">
        <hr>
        <div class="uk-text-muted">
  <div class="uk-margin-small">
    Made with <span uk-icon="icon: heart; ratio: 0.75"></span> by Oracle Developers
  </div>
  Copyright © 2021 Oracle and/or its affiliates. All rights reserved.
</div>
      </section>
    </div>
  </aside>
  
  <div class="uk-width-1-1 uk-width-1-3@s uk-width-1-4@m uk-width-1-5@l uk-width-1-6@xl uk-visible@s"></div>



    <div class="content-container uk-width-expand">
      <div class="uk-position-relative">
        <div id="content" class="uk-grid uk-container-xlarge" uk-grid>
          

<div class="uk-flex-last uk-width-1-4 uk-visible@l">
  <aside id="toc-nav" uk-sticky="offset: 40">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#introduction">Introduction</a></li>
            <li><a href="#deploy-mushop">Deploy MuShop</a></li>
            <li><a href="#oracle-cloud-infrastructure-oci-notifications">Oracle Cloud Infrastructure (OCI) Notifications</a></li>
            <li><a href="#oracle-cloud-infrastructure-oci-logging">Oracle Cloud Infrastructure (OCI) Logging</a></li>
            <li><a href="#oracle-cloud-infrastructure-oci-service-connector-hub">Oracle Cloud Infrastructure (OCI) Service Connector Hub</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
    <hr/>
    
  <div>
    
    <a class="uk-label" href="../../../tags/oci-logging">
      <span uk-icon="tag"></span>
      OCI Logging
    </a>
    
    <a class="uk-label" href="../../../tags/oci-notifications">
      <span uk-icon="tag"></span>
      OCI Notifications
    </a>
    
    <a class="uk-label" href="../../../tags/oci-service-connector-hub">
      <span uk-icon="tag"></span>
      OCI Service Connector Hub
    </a>
    
    <a class="uk-label" href="../../../tags/deploy-mushop">
      <span uk-icon="tag"></span>
      Deploy MuShop
    </a>
    
    <a class="uk-label" href="../../../tags/fluentd">
      <span uk-icon="tag"></span>
      fluentd
    </a>
    
    <a class="uk-label" href="../../../tags/logging">
      <span uk-icon="tag"></span>
      logging
    </a>
    
    <a class="uk-label" href="../../../tags/alarms">
      <span uk-icon="tag"></span>
      alarms
    </a>
    
    <a class="uk-label" href="../../../tags/notifications">
      <span uk-icon="tag"></span>
      notifications
    </a>
    
  </div>

  </aside>
</div>


          <main class="uk-width-expand">
            <header>
  
  
    <ul class="uk-breadcrumb uk-margin-top uk-text-small">
    
  
  
  <li><a href='../../../'>Home</a></li> <li><a href='../../../observability/'>Observability</a></li> <li><a href='../../../observability/observability-example/'>Observability Example</a></li> <li>Setup</li>
    </ul></header>



            <h1 class="rw-accent">Setup</h1>
              
  <h3 id="introduction">Introduction</h3>
<p>In this section we will deploy MuShop, Oracle Cloud Infrastructure (OCI) Notifications, Logging and Service Connector Hub.</p>
<h3 id="deploy-mushop">Deploy MuShop</h3>
<div uk-alert class="uk-alert-information uk-grid uk-grid-collapse uk-flex-nowrap "><span uk-icon="icon: warning; ratio: 1.2" class="uk-margin-small-right uk-flex-none"></span><div class="uk-width-expand">
<p>We will be deploying MuShop on Oracle Cloud Infrastructure Container Engine for Kubernetes (OKE)</p>
</div></div>
<ul>
<li>
<p>Perform just the Setup instructions from here <a href="../../../quickstart/kubernetes/">MuShop Setup</a></p>
</li>
<li>
<p>Deploy</p>
<pre><code>cd deploy/complete/kubernetes
</code></pre><div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">kubectl -n mushop apply -f mushop.yaml
</code></pre></div><p>Wait for services to be Ready</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">kubectl get pod --watch --namespace mushop
</code></pre></div></li>
<li>
<p>Expose</p>
</li>
</ul>
<div uk-grid class=" uk-margin-bottom uk-grid-small ">
  <div class="uk-width-1-1 uk-width-auto@m">
    <ul class="uk-tab-left uk-text-large" uk-tab="connect: #switcher-181"><li><a href="#">Local</a></li><li><a href="#">Ingress</a></li></ul>
  </div>
  <div class="uk-width-expand@m">
    <ul id='switcher-181' class='uk-switcher'>
<li>
<p>Use port-forward to expose the service</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">  kubectl port-forward <span class="se">\
</span><span class="se"></span>  --namespace mushop <span class="se">\
</span><span class="se"></span>  svc/edge 8000:80
</code></pre></div><p>Open browser <a href="http://localhost:8000">http://localhost:8000</a>;</p>
</li>
<li>
<p>Fetch the External IP</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">kubectl get svc mushop-utils-ingress-nginx-controller <span class="se">\
</span><span class="se"></span>--namespace mushop-utilities
</code></pre></div><p>Open browser http://&lt;EXTERNAL-IP&gt;:8000</p>
</li>
</ul>
  </div>
</div>
<h3 id="oracle-cloud-infrastructure-oci-notifications">Oracle Cloud Infrastructure (OCI) Notifications</h3>
<ul>
<li>
<p>Navigate to <code>Application Integration -&gt; Notifications -&gt; Create Topic</code></p>
</li>
<li>
<p>Navigate to your Topic and <code>Create Subscription -&gt; Email</code></p>
</li>
<li>
<p>Add you Email and create. The Email subscription will change to pending state.</p>
</li>
</ul>
<p>Sample Email you receive would look like this:</p>
<blockquote>
<p>You have chosen to subscribe to the topic:
Mushop-Topic (Topic OCID: ocid1.onstopic.oc1.phx.xxx)</p>
</blockquote>
<blockquote>
<p>To confirm this subscription, click or visit the link below (If this was in error, you can ignore this message):
Confirm subscription</p>
</blockquote>
<blockquote>
<p>&ndash;
Please do not reply directly to this email. If you have any questions or comments regarding this email, contact &gt; your account administrator.</p>
</blockquote>
<p>Once you confirm the subscription it changes to Active state.</p>
<h3 id="oracle-cloud-infrastructure-oci-logging">Oracle Cloud Infrastructure (OCI) Logging</h3>
<p>The Oracle Cloud Infrastructure (OCI) Logging service is a highly scalable and fully managed single pane of glass for all the logs in a tenancy.</p>
<p>In this section we will be enabling OCI (Oracle Cloud Infrastructure) logging for OKE (Oracle Cloud Infrastructure Container Engine for Kubernetes) worker nodes.</p>
<p>All the OKE pod logs (stdout and stderr) are written to /var/log/containers in a JSON format by default.</p>
<p>Example:</p>
<pre><code>Log File Name Format: &lt;Pod&gt;_&lt;NameSpace&gt;_&lt;ContainerName&gt;-&lt;ContainerID&gt;.log
Log File Content Format:  {&quot;log&quot;:&quot;&lt;message&gt;&quot;,&quot;stream&quot;:&quot;&lt;stdout|stderr&gt;&quot;,&quot;time&quot;:&quot;&lt;timestamp&gt;&quot;}
</code></pre><div uk-alert class="uk-alert-warning uk-grid uk-grid-collapse uk-flex-nowrap "><span uk-icon="icon: warning; ratio: 1.2" class="uk-margin-small-right uk-flex-none"></span><div class="uk-width-expand">
<p>Ensure that the worker nodes are running OL 7.6 and above.</p>
</div></div>
<ol>
<li>Create a Dynamic Group</li>
</ol>
<p>Create a dynamic group and add your worker nodes.
Navigate to <code>Identity -&gt; Dynamic Groups -&gt; Create Dynamic Group</code></p>
<pre><code>Name: &lt;DynamicGroupName&gt;
Description: &lt;DynamicGroupDescription&gt;
Matching Rules: any {instance.compartment.id = 'CompartmentOCID'}
</code></pre>
<ol start="2">
<li>Create a IAM Policy</li>
</ol>
<p>Navigate to <code>Identity -&gt; Policies -&gt; Create Policy</code></p>
<pre><code>Name: &lt;PolicyName&gt;
Description: &lt;PolicyDescription&gt;
Policy Versioning: Keep version current
Statement: allow dynamic-group &lt;DynamicGroupName&gt; to use log-content in tenancy
</code></pre>
<ol start="3">
<li>Enable Logging</li>
</ol>
<p>To enable Logging on OKE, perform the following actions:</p>
<ul>
<li>Create a Log Group - This is a logical container for organizing logs, Identity and Access Management (IAM) policies can control who has access to a Log Group.</li>
<li>Create a Custom Log - The Custom Log will contain all information that is uploaded by the Agent Configuration.</li>
<li>Create an Agent Configuration - Defines the Source Log location and relevant Parsers along with the Dynamic Group containing all the Instance to which the configuration should apply.</li>
</ul>
<ol start="4">
<li>Create a Log Group</li>
</ol>
<p>Navigate to <code>Logging -&gt; Log Groups -&gt; Create Log Group</code></p>
<pre><code>Compartment: &lt;SelectCompartment
Name: &lt;LogGroupName&gt;
Description:  &lt;LogGroupDescription&gt;
</code></pre>
<ol start="5">
<li>Create a Custom Log</li>
</ol>
<p>Navigate to <code>Logging -&gt; Logs -&gt; Create Custom Log</code></p>
<pre><code>Custom Log Name: &lt;CustomLogName&gt;
Compartment: &lt;SelectCompartment&gt;
Log Group: &lt;SelectLogGroup&gt;
Show Additional Option:
Select Log Retention: 1, 2, 3, 4, 5 or 6 months
</code></pre>
<ol start="6">
<li>Create Agent Configuration</li>
</ol>
<p>Navigate to <code>Logging -&gt; Agent Configurations -&gt; Create Agent Config</code></p>
<pre><code>Configuration Name: &lt;ConfigurationName&gt;
Compartment: &lt;SelectCompartment&gt;
Group Type: Dynamic Group
Group: &lt;SelectDynamicGroup&gt;
Configure Log Inputs:
    Input Type: Log Path
    Input Name: &lt;InputName&gt;
    File Paths: /var/log/containers/*.log
Advanced Parser Options:
    Parser: JSON
    Time Format: %Y-%m-%dT%H:%M:%S.%NZ
Select Log Destination:
    Compartment: &lt;SelectCompartment&gt;
    Log Group: &lt;SelectLogGroup&gt;
    Log Name: &lt;SelectLogName&gt;
</code></pre>
<p><img src="../../images/agent-config.png" alt="agent-config"></p>
<div uk-alert class="uk-alert-information uk-grid uk-grid-collapse uk-flex-nowrap "><span uk-icon="icon: warning; ratio: 1.2" class="uk-margin-small-right uk-flex-none"></span><div class="uk-width-expand">
<p>The JSON parser helps analyze the the pod logs format.</p>
</div></div>
<div uk-alert class="uk-alert-information uk-grid uk-grid-collapse uk-flex-nowrap "><span uk-icon="icon: warning; ratio: 1.2" class="uk-margin-small-right uk-flex-none"></span><div class="uk-width-expand">
<p>Here we are targeting all the pod logs by using /var/log/containers/*.log. However, we can also target a specific pod. Example: /var/log/containers/mushop-orders*.log in this case.</p>
</div></div>
<ol start="7">
<li>Verify the fluentd.conf</li>
</ol>
<p>ssh into worker node where the <code>mushop-orders</code> pod is running</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">kubectl -n mushop get pods,nodes -o wide
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">ssh opc@&lt;IP_OF_WORKER_NODE&gt;
</code></pre></div><pre><code>cat /etc/unified-monitoring-agent/conf.d/fluentd_config/fluentd.conf
</code></pre><blockquote>
<blockquote>
<p>Example output:</p>
</blockquote>
</blockquote>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">worker-node-1$ cat /etc/unified-monitoring-agent/conf.d/fluentd_config/fluentd.conf
    &lt;source&gt;
        @type tail
        tag 677561.varlogcontainers
        path  /var/log/containers/*.log
        pos_file  /etc/unifiedmonitoringagent/pos/677561-varlogcontainers.pos
        path_key  tailed_path
        &lt;parse&gt;
            @type json
            time_type  string
            time_format  %Y-%m-%dT%H:%M:%S.%NZ
        &lt;/parse&gt;
    &lt;/source&gt;

    &lt;match 677561.**&gt;
        @type oci_logging
        log_object_id  ocid1.log.oc1.phx.xxxx
        &lt;buffer tag&gt;
            @type file
            retry_timeout  3h
            path  /opt/unifiedmonitoringagent/run/buffer/677561
            disable_chunk_backup  true
            chunk_limit_size  5MB
            flush_interval  180s
            total_limit_size  1GB
            overflow_action  throw_exception
            retry_type  exponential_backoff
        &lt;/buffer&gt;
    &lt;/match&gt;
</code></pre></div><p>If you dont see your defined agent config then wait for few more minutes for the agent config to get uploaded onto the worker nodes. Impatient users can restart the unified-monitoring-agent_config_downloader.timer service to download the config immediately.</p>
<h3 id="oracle-cloud-infrastructure-oci-service-connector-hub">Oracle Cloud Infrastructure (OCI) Service Connector Hub</h3>
<p>Service Connector Hub orchestrates data movement between services in Oracle Cloud Infrastructure.</p>
<p>Data is moved using service connectors. A service connector specifies the source service that contains the data to be moved, tasks to run on the data, and the target service for delivery of data when tasks are complete.</p>
<p>In this case, we are filtering &ldquo;Payment declined&rdquo; messages and sending out the metrics to OCI Monitoring on a custom metric named &ldquo;payment-declined&rdquo;.</p>
<p>Navigate to <code>Logging -&gt; Service Connectors -&gt; Create Connector</code></p>
<pre><code>Name: &lt;Service Connector Name&gt;
Description: &lt;Service Connector Description&gt;
source: Logging
target: Monitoring
Switch to Advanced mode:
  search &quot;ocid1.compartment.oc1..xxxx/ocid1.loggroup.oc1.phx.xxxx/ocid1.log.oc1.phx.xxxx&quot; |  logContent='*Payment declined*' and subject='/var/log/containers/*_mushop_*.log' 
metricnamespace: &lt;CustomMetricNameSpace&gt;
metric: &lt;CustomMetricName&gt;
</code></pre>
<p><img src="../../images/service-connector.png" alt="service-connector"></p>


            </main>
          </div> 
        </div> 
      </div> 
    </div> 
    
<footer class="uk-position-fixed uk-position-bottom">
  <div class="uk-grid">
    
    
    <div class="uk-width-1-1 uk-width-1-3@s uk-width-1-4@m uk-width-1-5@l uk-width-1-6@xl uk-visible@s"></div>
    <div class="uk-width-expand">
      <div>
      
      
      
      


  
    
    
  

  
  
  
    
  

  
  
    


  
    
      
      
    
  

  
  
  

  
  


  
    


  
    
  

  
  
  

  
  
    


  
    
  

  
  
  

  
  


  
    


  
    
  

  
  
  

  
  


  


  
    


  
    
  

  
  
  

  
  
    


  
    
  

  
  
  

  
  


  
    


  
    
  

  
  
  

  
  


  
    


  
    
  

  
  
  

  
  


  


  
    


  
    
    
  

  
  
  
    
  

  
  
    


  
    
      
      
    
  

  
  
  

  
  


  
    


  
    
  

  
  
  

  
  


  
    


  
    
  

  
  
  

  
  


  
    


  
    
  

  
  
  

  
  


  
    


  
    
  

  
  
  

  
  


  
    


  
    
    
  

  
  
  

  
  
    


  
    
    
  

  
  
  

  
  


  
    


  
    
      
      
    
  

  
  
  

  
  


  


  


  
    


  
    
  

  
  
  

  
  
    


  
    
  

  
  
  

  
  


  


  
    


  
    
  

  
  
  

  
  


  


        <div class="uk-flex uk-flex-between uk-margin-top">
          <a href="../../../observability/observability-example/" title="Observability Example" class="rw-page-prev uk-flex-first uk-flex uk-flex-left uk-flex-middle uk-text-truncate">
            <span uk-icon="icon: chevron-left; ratio: 2.5" class="uk-margin-small-right uk-flex-none"></span>
            <label class="uk-visible@m">Observability Example</label>
          </a><span></span>
          <a href="../../../observability/observability-example/usecase/" title="Use Case" class="rw-page-next uk-flex-last uk-flex uk-flex-right uk-flex-middle uk-flex-last uk-text-truncate">
            <label class="uk-visible@m">Use Case</label>
            <span uk-icon="icon: chevron-right; ratio: 2.5" class="uk-margin-small-left uk-flex-none"></span>
          </a></div>
      </div>
    </div>
  </div>
</footer>


    <script type="text/javascript">
  (function(w, s) {
    Object.assign(s, {
      BaseURL: '',
      RelURL: '\/',
      cssConfig: {
        table: 'uk-table uk-table-small uk-table-striped',
        '#TableOfContents > ul': 'uk-nav uk-nav-default uk-nav-parent-icon',
        '#TableOfContents > ul ul': 'uk-nav-sub',
      },
      uikit: {
        '#TableOfContents > ul': ['scrollspyNav', { closest: 'li', offset: 10 }],
        
      }
    });
  })(window, window.Site = window.Site || {});
</script>

<script src="../../../js/vendor.min.635fbc23a7f80d0fcee6728a32611ece1edb8302f818f627011b23dc8de8c6d4.js" ></script><script src="../../../js/extras.min.a9bf7ac5b6f2ffe1f85649105cb5f3065ab48c7ce45fa8efd51bce9622933221.js"  async></script><script src="../../../js/site.min.5a6d5008222f09cfe0ff51eb81d80c68d7d2fa56fa9ea1dd327f239f4c5d044d.js"  async></script>
  </body>
</html>